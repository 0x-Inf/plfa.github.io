\documentclass[10pt]{book}

\usepackage{hyperref}
\usepackage[links]{agda}
\usepackage{fontspec}
\setmainfont{DejaVu Sans}
\setsansfont{DejaVu Sans}
\setmonofont{[DejaVu-mononoki-Symbola-Droid.ttf]}
\usepackage{soul}
\usepackage[most]{tcolorbox}
\tcbuselibrary{skins,breakable}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{setspace}

% Wrap texttt lines
\sloppy

% Disable section numbering
\setcounter{secnumdepth}{0}

% Change background color for inline code in markdown files.
% The following code does not work well for long text as the
% text will exceed the page boundary.
\definecolor{bgcolor}{HTML}{EEEEFF}
\let\oldtexttt\texttt%
\renewcommand{\texttt}[1]{\colorbox{bgcolor}{\oldtexttt{#1}}}

% Indent verbatim to be the same as agda code blocks.
\lstdefinestyle{codeBlockStyle}{
  basicstyle=\ttfamily,
  numbers=none
}
\newtcolorbox{agda}[1][]{
  frame hidden,
  colback=bgcolor,
  spartan,
  left=5pt,
  boxrule=0pt,
  breakable,
}
\newtcblisting{pre}{
  frame hidden,
  colback=bgcolor,
  spartan,
  width=\textwidth,
  listing only,
  listing options={style=codeBlockStyle},
  arc=0mm,
  top=0mm,
  bottom=0mm,
  left=0mm,
  right=0mm,
  boxrule=0pt,
  breakable,
}

\usepackage{geometry}
 \geometry{
 a4paper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
}

% Use special font families without TeX ligatures for Agda code.
% Solution inspired by a comment by Enrico Gregorio:
% https://tex.stackexchange.com/a/103078
\newfontfamily{\AgdaSerifFont}{DejaVu-Serif}
\newfontfamily{\AgdaSansSerifFont}{DejaVu-Sans}
\newfontfamily{\AgdaTypewriterFont}{DejaVu-mononoki-Symbola-Droid}
\renewcommand{\AgdaFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaKeywordFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaStringFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaCommentFontStyle}[1]{{\AgdaTypewriterFont{}#1}}
\renewcommand{\AgdaBoundFontStyle}[1]{{\AgdaTypewriterFont{}#1}}

\AgdaNoSpaceAroundCode{}

\setlength{\parindent}{0em}
\setlength{\parskip}{1em}

% Adjust spacing after toc numbering
\usepackage{tocloft}
\setlength\cftchapnumwidth{3em}
\cftsetpnumwidth{4em}

% Style links with colors instead of boxes:
% https://tex.stackexchange.com/q/823
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}

\begin{document}

% Adjust indentation of agda codeblocks
\setlength{\mathindent}{0pt}

% Provide \tightlist environment
% https://tex.stackexchange.com/q/257418
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% https://ctan.org/pkg/titlepages
% https://latex.org/forum/viewtopic.php?t=2843
\begin{titlepage}
  \newlength{\drop}
  \setlength{\drop}{0.12\textheight}%
  \centering%
  \begingroup% Ancient Mariner, AW p. 151
  \vspace*{\drop}%
  {\large Philip Wadler, Wen Kokke, and Jeremy G. Siek}\\[\baselineskip]
  {\Huge PROGRAMMING LANGUAGE FOUNDATIONS}\\[\baselineskip]
  {\Large IN}\\[\baselineskip]
  {\Huge Agda}\\[\drop]
  \vfill%
  {\small\scshape 2021}\par%
  \null\endgroup
\end{titlepage}

\frontmatter
\setcounter{tocdepth}{0}

\tableofcontents
\setcounter{tocdepth}{1}

\input{plfa/frontmatter/dedication}
\input{plfa/frontmatter/preface}
\input{plfa/frontmatter/README}

\mainmatter
\part{Part 1: Logical Foundations}
\input{plfa/part1/Naturals}
\input{plfa/part1/Induction}
\input{plfa/part1/Relations}
\input{plfa/part1/Equality}
\input{plfa/part1/Isomorphism}
\input{plfa/part1/Connectives}
\input{plfa/part1/Negation}
\input{plfa/part1/Quantifiers}
\input{plfa/part1/Decidable}
\input{plfa/part1/Lists}

\part{Part 2: Programming Language Foundations}
\input{plfa/part2/Lambda}
\input{plfa/part2/Properties}
\input{plfa/part2/DeBruijn}
\input{plfa/part2/More}
\input{plfa/part2/Bisimulation}
\input{plfa/part2/Inference}
\input{plfa/part2/Untyped}
\input{plfa/part2/Confluence}
\input{plfa/part2/BigStep}

\part{Part 3: Denotational Semantics}
\input{plfa/part3/Denotational}
\input{plfa/part3/Compositional}
\input{plfa/part3/Soundness}
\input{plfa/part3/Adequacy}
\input{plfa/part3/ContextualEquivalence}

\cleardoublepage%
\phantomsection%

\appendix
\addcontentsline{toc}{part}{Appendices}

\input{plfa/part2/Substitution}
\input{plfa/backmatter/acknowledgements}
\input{plfa/backmatter/Fonts}
\end{document}
